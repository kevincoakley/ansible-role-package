---
- name: include apt_repository.yml
  include_tasks: apt_repository.yml
  when: ansible_os_family == "Debian"

- name: include yum_repository.yml
  include_tasks: yum_repository.yml
  when: ansible_os_family == "RedHat"

- name: Install pre-packages
  package:
    name: "{{ item.name }}"
    state: "{{ item.state | default(pre_package_state) }}"
  with_items: "{{ pre_package }}"

- name: Install packages
  package:
    name: "{{ item.name }}"
    state: "{{ item.state | default(package_state) }}"
  with_items: "{{ package }}"

- name: Install post-packages
  package:
    name: "{{ item.name }}"
    state: "{{ item.state | default(post_package_state) }}"
  with_items: "{{ post_package }}"

- name: include yum_versionlock.yml
  include_tasks: yum_versionlock.yml
  when: ansible_os_family == "RedHat"